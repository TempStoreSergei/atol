# Changelog

Все изменения в проекте документируются в этом файле.

## [0.2.0] - 2024-01-15

### Добавлено

#### Основной функционал
- **AtolDriver** - полноценный Python wrapper для драйвера АТОЛ ККТ v.10 (libfptr10)
- Поддержка всех типов подключения: TCP/IP, USB, Serial (COM-порт), Bluetooth
- Контекстный менеджер для автоматического управления подключением

#### Операции с чеками
- Открытие чеков всех типов: продажа, возврат, покупка
- Добавление товаров с полными атрибутами (цена, количество, НДС, единица измерения)
- Поддержка всех типов оплаты: наличные, электронные, предоплата, кредит
- Смешанная оплата (несколько платежей в одном чеке)
- Закрытие чека с получением фискальных данных
- Отмена чека

#### Чеки коррекции
- Открытие чеков коррекции (самостоятельные и по предписанию)
- Добавление позиций коррекции с описанием
- Документ основания для коррекции

#### Управление сменой
- Открытие смены с указанием кассира
- Закрытие смены (Z-отчет)
- Получение статуса смены (открыта/закрыта, номер, количество чеков)
- Печать X-отчета без гашения

#### Денежные операции
- Внесение наличных в кассу
- Выплата наличных из кассы

#### Информация об устройстве
- Получение полной информации о ККТ (модель, серийный номер, версия ПО)
- Получение данных о фискальном накопителе
- ИНН и регистрационный номер ККТ

#### Модели данных
- Обновлены все Enum на IntEnum для совместимости с драйвером
- Добавлен `PaymentMethodType` (признак способа расчета по 54-ФЗ)
- Добавлен `PaymentObjectType` (признак предмета расчета по 54-ФЗ)
- Расширен класс `Item` дополнительными атрибутами
- Добавлены типы коррекции в `ReceiptType`

#### Вспомогательные функции
- Звуковой сигнал (beep)
- Открытие денежного ящика
- Отрезка чека
- Проверка подключения

#### Документация
- Полное обновление README.md с примерами
- Создан API_REFERENCE.md с подробным описанием всех методов
- Создан INSTALLATION.md с инструкциями по установке
- Обновлен CLAUDE.md с архитектурой и рекомендациями
- Добавлен CHANGELOG.md

#### Примеры
- `driver_basic_usage.py` - базовый пример продажи
- `driver_advanced_usage.py` - расширенные примеры:
  - Чек возврата
  - Смешанная оплата
  - Чек коррекции
  - Денежные операции
  - Управление сменой
  - Разные типы подключения
  - Контекстный менеджер

#### Инструменты разработки
- Обновлен Makefile с новыми командами
- Добавлена команда `make help`
- Добавлена команда `make run-advanced`
- Улучшены команды lint и format

### Изменено

- Версия обновлена с 0.1.0 (Alpha) до 0.2.0 (Beta)
- `VatType` переименован в `TaxType` и изменен на IntEnum
- `ReceiptType` изменен на IntEnum со значениями 0-5
- `PaymentType` изменен на IntEnum со значениями 0-4
- Обновлен `setup.py` с дополнительными метаданными
- Обновлен `requirements.txt` с комментариями о драйвере
- Обновлен `__init__.py` для удобного импорта всех классов

### Исправлено

- Исправлена кодировка в некоторых файлах
- Улучшена обработка ошибок драйвера
- Добавлено логирование во все операции

## [0.1.0] - 2024-01-01

### Добавлено

- Первоначальная структура проекта
- Stub-реализации для AtolClient и AtolWebServer
- Базовые модели данных (Receipt, Item, Payment, DeviceInfo)
- Конфигурация через Pydantic и .env
- Начальная документация
- Структура тестов

### Известные ограничения

- AtolClient и AtolWebServer содержат только заглушки
- FiscalService не реализован
- Нет unit и integration тестов
- DeviceInfo.from_dict() не реализован

---

## Формат

Этот файл следует формату [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

### Типы изменений

- **Добавлено** - для новых функций
- **Изменено** - для изменений в существующей функциональности
- **Устарело** - для функций, которые скоро будут удалены
- **Удалено** - для удаленных функций
- **Исправлено** - для исправления ошибок
- **Безопасность** - в случае уязвимостей
